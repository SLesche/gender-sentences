<!DOCTYPE html>
<html>
  <head>
    <title>Picture Identification Task</title>
    <meta charset="UTF-8">
    <script src="jspsych/dist/jspsych.js"></script>
    <script src="jspsych/dist/plugin-html-keyboard-response.js"></script>
    <script src="jspsych/dist/plugin-image-keyboard-response.js"></script>
    <script src="jspsych/dist/plugin-html-button-response.js"></script>
    <script src="jspsych/dist/plugin-preload.js"></script>
    <script src="jspsych/dist/plugin-instructions.js"></script>
    <script src="jspsych/dist/plugin-survey.js"></script>
    <script src="jspsych/dist/plugin-survey-likert.js"></script>
    <script src="jspsych/dist/plugin-survey-text.js"></script>
    <link href="jspsych/dist/jspsych.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="css/stim_styles.css">
    <script src="scripts/setup.js"></script>
    <script src="scripts/helper_function.js"></script>
    <script src="scripts/instructions.js"></script>
    <script src="scripts/task.js"></script>
    <script src="scripts/debriefing.js"></script>
    <script src = "https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
  </head>
  <body></body>
  <script>
    // Function to set up the experiment after the CSV is loaded
    function setupExperiment(stimulus_list) {   
      const selected_trials = select_trials(stimulus_list); // Select trials for the experiment
      console.log("Setting up experiment with stimulus list: ", selected_trials);   
      var trial_num = 0;
      var block_num = 0;
      var repeat_practice_now = 1;

      console.log(stimulus_list[trial_num])
      
      // Read all files in the stimuli/imgs folder (run in Terminal)
      //       Get-ChildItem -Recurse -Path .\stimuli\imgs\ -Include *.png, *.jpg, *.jpeg, *.gif | 
      // ForEach-Object { $_.FullName.Replace($pwd.Path + '\', '') } | 
      // ForEach-Object { "'$($_.Replace('\', '/'))'," } > stimuli/imgs.txt

      const possible_images = [
        'stimuli/imgs/FS_astronauten_laufen_bahnhof_frauen.jpg',
        'stimuli/imgs/FS_astronauten_laufen_bahnhof_gemischt.jpg',
        'stimuli/imgs/FS_astronauten_laufen_bahnhof_männer.jpg',
        'stimuli/imgs/FS_astronauten_laufen_flugzeug_frauen.jpg',
        'stimuli/imgs/FS_astronauten_laufen_flugzeug_gemischt.jpg',
        'stimuli/imgs/FS_astronauten_laufen_flugzeug_männer.jpg',
        'stimuli/imgs/FS_astronauten_liegen_bibliothek_frauen.jpg',
        'stimuli/imgs/FS_astronauten_liegen_bibliothek_gemischt.jpg',
        'stimuli/imgs/FS_astronauten_liegen_bibliothek_männer.jpg',
        'stimuli/imgs/FS_astronauten_schachspielen_burg_frauen.jpg',
        'stimuli/imgs/FS_astronauten_schachspielen_burg_gemischt.jpg',
        'stimuli/imgs/FS_astronauten_schachspielen_burg_männer.jpg',
        'stimuli/imgs/FS_astronauten_sitzen_zug_frauen.jpg',
        'stimuli/imgs/FS_astronauten_sitzen_zug_gemischt.jpg',
        'stimuli/imgs/FS_astronauten_sitzen_zug_männer.jpg',
        'stimuli/imgs/FS_kellner_essen_bahnhof_frauen.jpg',
        'stimuli/imgs/FS_kellner_essen_bahnhof_gemischt.jpg',
        'stimuli/imgs/FS_kellner_essen_bahnhof_männer.jpg',
        'stimuli/imgs/FS_kellner_kaffeetrinken_burg_frauen.jpg',
        'stimuli/imgs/FS_kellner_kaffeetrinken_burg_gemischt.jpg',
        'stimuli/imgs/FS_kellner_kaffeetrinken_burg_männer.jpg',
        'stimuli/imgs/FS_kellner_liegen_supermarkt_frauen.jpg',
        'stimuli/imgs/FS_kellner_liegen_supermarkt_gemischt.jpg',
        'stimuli/imgs/FS_kellner_liegen_supermarkt_männer.jpg',
        'stimuli/imgs/FS_kellner_sitzen_brunnen_frauen.jpg',
        'stimuli/imgs/FS_kellner_sitzen_brunnen_gemischt.jpg',
        'stimuli/imgs/FS_kellner_sitzen_brunnen_männer.jpg',
        'stimuli/imgs/FS_kinobesucher_boxen_bibliothek_frauen.jpg',
        'stimuli/imgs/FS_kinobesucher_boxen_bibliothek_gemischt.jpg',
        'stimuli/imgs/FS_kinobesucher_boxen_bibliothek_männer.jpg',
        'stimuli/imgs/FS_kinobesucher_essen_brunnen_frauen.jpg',
        'stimuli/imgs/FS_kinobesucher_essen_brunnen_gemischt.jpg',
        'stimuli/imgs/FS_kinobesucher_essen_brunnen_männer.jpg',
        'stimuli/imgs/FS_kinobesucher_laufen_vulkan_frauen.jpg',
        'stimuli/imgs/FS_kinobesucher_laufen_vulkan_gemischt.jpg',
        'stimuli/imgs/FS_kinobesucher_laufen_vulkan_männer.jpg',
        'stimuli/imgs/FS_kinobesucher_schachspielen_flugzeug_frauen.jpg',
        'stimuli/imgs/FS_kinobesucher_schachspielen_flugzeug_gemischt.jpg',
        'stimuli/imgs/FS_kinobesucher_schachspielen_flugzeug_männer.jpg',
        'stimuli/imgs/FS_kinobesucher_seilspringen_zug_frauen.jpg',
        'stimuli/imgs/FS_kinobesucher_seilspringen_zug_gemischt.jpg',
        'stimuli/imgs/FS_kinobesucher_seilspringen_zug_männer.jpg',
        'stimuli/imgs/FS_kinobesucher_sitzen_zoo_frauen.jpg',
        'stimuli/imgs/FS_kinobesucher_sitzen_zoo_gemischt.jpg',
        'stimuli/imgs/FS_kinobesucher_sitzen_zoo_männer.jpg',
        'stimuli/imgs/FS_köche_essen_flugzeug_frauen.jpg',
        'stimuli/imgs/FS_köche_essen_flugzeug_gemischt.jpg',
        'stimuli/imgs/FS_köche_essen_flugzeug_männer.jpg',
        'stimuli/imgs/FS_köche_kaffeetrinken_zoo_frauen.jpg',
        'stimuli/imgs/FS_köche_kaffeetrinken_zoo_gemischt.jpg',
        'stimuli/imgs/FS_köche_kaffeetrinken_zoo_männer.jpg',
        'stimuli/imgs/FS_köche_lesen_brunnen_frauen.jpg',
        'stimuli/imgs/FS_köche_lesen_brunnen_gemischt.jpg',
        'stimuli/imgs/FS_köche_lesen_brunnen_männer.jpg',
        'stimuli/imgs/FS_köche_seilspringen_bahnhof_frauen.jpg',
        'stimuli/imgs/FS_köche_seilspringen_bahnhof_gemischt.jpg',
        'stimuli/imgs/FS_köche_seilspringen_bahnhof_männer.jpg',
        'stimuli/imgs/FS_köche_seilspringen_supermarkt_frauen.jpg',
        'stimuli/imgs/FS_köche_seilspringen_supermarkt_gemischt.jpg',
        'stimuli/imgs/FS_köche_seilspringen_supermarkt_männer.jpg',
        'stimuli/imgs/FS_laborassistenten_essen_brunnen_ frauen.jpg',
        'stimuli/imgs/FS_laborassistenten_essen_brunnen_ gemischt.jpg',
        'stimuli/imgs/FS_laborassistenten_essen_brunnen_ männer.jpg',
        'stimuli/imgs/FS_laborassistenten_kaffeetrinken_supermarkt_frauen.jpg',
        'stimuli/imgs/FS_laborassistenten_kaffeetrinken_supermarkt_gemischt.jpg',
        'stimuli/imgs/FS_laborassistenten_kaffeetrinken_supermarkt_männer.jpg',
        'stimuli/imgs/FS_laborassistenten_lesen_bahnhof_frauen.jpg',
        'stimuli/imgs/FS_laborassistenten_lesen_bahnhof_gemischt.jpg',
        'stimuli/imgs/FS_laborassistenten_lesen_bahnhof_männer.jpg',
        'stimuli/imgs/FS_laborassistenten_liegen_zoo_frauen.jpg',
        'stimuli/imgs/FS_laborassistenten_liegen_zoo_gemischt.jpg',
        'stimuli/imgs/FS_laborassistenten_liegen_zoo_männer.jpg',
        'stimuli/imgs/FS_maler_boxen_burg_frauen.jpg',
        'stimuli/imgs/FS_maler_boxen_burg_gemischt.jpg',
        'stimuli/imgs/FS_maler_boxen_burg_männer.jpg',
        'stimuli/imgs/FS_maler_laufen_zug_frauen.jpg',
        'stimuli/imgs/FS_maler_laufen_zug_gemischt.jpg',
        'stimuli/imgs/FS_maler_laufen_zug_männer.jpg',
        'stimuli/imgs/FS_maler_liegen_flugzeug_frauen.jpg',
        'stimuli/imgs/FS_maler_liegen_flugzeug_gemischt.jpg',
        'stimuli/imgs/FS_maler_liegen_flugzeug_männer.jpg',
        'stimuli/imgs/FS_maler_schachspielen_bibliothek_frauen.jpg',
        'stimuli/imgs/FS_maler_schachspielen_bibliothek_gemischt.jpg',
        'stimuli/imgs/FS_maler_schachspielen_bibliothek_männer.jpg',
        'stimuli/imgs/FS_maler_sitzen_vulkan_frauen.jpg',
        'stimuli/imgs/FS_maler_sitzen_vulkan_gemischt.jpg',
        'stimuli/imgs/FS_maler_sitzen_vulkan_männer.jpg',
        'stimuli/imgs/FS_musiker_boxen_flugzeug_frauen.jpg',
        'stimuli/imgs/FS_musiker_boxen_flugzeug_gemischt.jpg',
        'stimuli/imgs/FS_musiker_boxen_flugzeug_männer.jpg',
        'stimuli/imgs/FS_musiker_laufen_zoo_frauen.jpg',
        'stimuli/imgs/FS_musiker_laufen_zoo_gemischt.jpg',
        'stimuli/imgs/FS_musiker_laufen_zoo_männer.jpg',
        'stimuli/imgs/FS_musiker_lesen_bibliothek_frauen.jpg',
        'stimuli/imgs/FS_musiker_lesen_bibliothek_gemischt.jpg',
        'stimuli/imgs/FS_musiker_lesen_bibliothek_männer.jpg',
        'stimuli/imgs/FS_musiker_schachspielen_brunnen_frauen.jpg',
        'stimuli/imgs/FS_musiker_schachspielen_brunnen_gemischt.jpg',
        'stimuli/imgs/FS_musiker_schachspielen_brunnen_männer.jpg',
        'stimuli/imgs/FS_musiker_seilspringen_vulkan_frauen.jpg',
        'stimuli/imgs/FS_musiker_seilspringen_vulkan_gemischt.jpg',
        'stimuli/imgs/FS_musiker_seilspringen_vulkan_männer.jpg',
        'stimuli/imgs/FS_schwimmer_boxen_brunnen_frauen.jpg',
        'stimuli/imgs/FS_schwimmer_boxen_brunnen_gemischt.jpg',
        'stimuli/imgs/FS_schwimmer_boxen_brunnen_männer.jpg',
        'stimuli/imgs/FS_schwimmer_kaffeetrinken_vulkan_frauen.jpg',
        'stimuli/imgs/FS_schwimmer_kaffeetrinken_vulkan_gemischt.jpg',
        'stimuli/imgs/FS_schwimmer_kaffeetrinken_vulkan_männer.jpg',
        'stimuli/imgs/FS_schwimmer_laufen_supermarkt_frauen.jpg',
        'stimuli/imgs/FS_schwimmer_laufen_supermarkt_gemischt.jpg',
        'stimuli/imgs/FS_schwimmer_laufen_supermarkt_männer.jpg',
        'stimuli/imgs/FS_schwimmer_laufen_vulkan_frauen.jpg',
        'stimuli/imgs/FS_schwimmer_laufen_vulkan_gemischt.jpg',
        'stimuli/imgs/FS_schwimmer_laufen_vulkan_männer.jpg',
        'stimuli/imgs/FS_schwimmer_lesen_flugzeug_frauen.jpg',
        'stimuli/imgs/FS_schwimmer_lesen_flugzeug_gemischt.jpg',
        'stimuli/imgs/FS_schwimmer_lesen_flugzeug_männer.jpg',
        'stimuli/imgs/FS_schwimmer_liegen_zoo_frauen.jpg',
        'stimuli/imgs/FS_schwimmer_liegen_zoo_gemischt.jpg',
        'stimuli/imgs/FS_schwimmer_liegen_zoo_männer.jpg',
        'stimuli/imgs/FS_schwimmer_seilspringen_zoo_frauen.jpg',
        'stimuli/imgs/FS_schwimmer_seilspringen_zoo_gemischt.jpg',
        'stimuli/imgs/FS_schwimmer_seilspringen_zoo_männer.jpg',
        'stimuli/imgs/FS_sportler_essen_zug_frauen.jpg',
        'stimuli/imgs/FS_sportler_essen_zug_gemischt.jpg',
        'stimuli/imgs/FS_sportler_essen_zug_männer.jpg',
        'stimuli/imgs/FS_sportler_liegen_burg_frauen.jpg',
        'stimuli/imgs/FS_sportler_liegen_burg_gemischt.jpg',
        'stimuli/imgs/FS_sportler_liegen_burg_männer.jpg',
        'stimuli/imgs/FS_sportler_schachspielen_supermarkt_frauen.jpg',
        'stimuli/imgs/FS_sportler_schachspielen_supermarkt_gemischt.jpg',
        'stimuli/imgs/FS_sportler_schachspielen_supermarkt_männer.jpg',
        'stimuli/imgs/FS_sportler_sitzen_bahnhof_frauen.jpg',
        'stimuli/imgs/FS_sportler_sitzen_bahnhof_gemischt.jpg',
        'stimuli/imgs/FS_sportler_sitzen_bahnhof_männer.jpg',
        'stimuli/imgs/TS_astronauten_boxen_supermarkt_frauen.jpg',
        'stimuli/imgs/TS_astronauten_boxen_supermarkt_gemischt.jpg',
        'stimuli/imgs/TS_astronauten_boxen_supermarkt_männer.jpg',
        'stimuli/imgs/TS_astronauten_essen_vulkan_frauen.jpg',
        'stimuli/imgs/TS_astronauten_essen_vulkan_gemischt.jpg',
        'stimuli/imgs/TS_astronauten_essen_vulkan_männer.jpg',
        'stimuli/imgs/TS_astronauten_kaffeetrinken_flugzeug_frauen.jpg',
        'stimuli/imgs/TS_astronauten_kaffeetrinken_flugzeug_gemischt.jpg',
        'stimuli/imgs/TS_astronauten_kaffeetrinken_flugzeug_männer.jpg',
        'stimuli/imgs/TS_astronauten_lesen_zoo_frauen.jpg',
        'stimuli/imgs/TS_astronauten_lesen_zoo_gemischt.jpg',
        'stimuli/imgs/TS_astronauten_lesen_zoo_männer.jpg',
        'stimuli/imgs/TS_astronauten_seilspringen_brunnen_frauen.jpg',
        'stimuli/imgs/TS_astronauten_seilspringen_brunnen_gemischt.jpg',
        'stimuli/imgs/TS_astronauten_seilspringen_brunnen_männer.jpg',
        'stimuli/imgs/TS_kellner_boxen_vulkan_frauen.jpg',
        'stimuli/imgs/TS_kellner_boxen_vulkan_gemischt.jpg',
        'stimuli/imgs/TS_kellner_boxen_vulkan_männer.jpg',
        'stimuli/imgs/TS_kellner_laufen_flugzeug_frauen.jpg',
        'stimuli/imgs/TS_kellner_laufen_flugzeug_gemischt.jpg',
        'stimuli/imgs/TS_kellner_laufen_flugzeug_männer.jpg',
        'stimuli/imgs/TS_kellner_lesen_zug_frauen.jpg',
        'stimuli/imgs/TS_kellner_lesen_zug_gemischt.jpg',
        'stimuli/imgs/TS_kellner_lesen_zug_männer.jpg',
        'stimuli/imgs/TS_kellner_schach_zoo_frauen.jpg',
        'stimuli/imgs/TS_kellner_schach_zoo_gemischt.jpg',
        'stimuli/imgs/TS_kellner_schach_zoo_männer.jpg',
        'stimuli/imgs/TS_kellner_seilspringen_bibliothek_frauen.jpg',
        'stimuli/imgs/TS_kellner_seilspringen_bibliothek_gemischt.jpg',
        'stimuli/imgs/TS_kellner_seilspringen_bibliothek_männer.jpg',
        'stimuli/imgs/TS_kinobesucher_essen_supermarkt_frauen.jpg',
        'stimuli/imgs/TS_kinobesucher_essen_supermarkt_gemischt.jpg',
        'stimuli/imgs/TS_kinobesucher_essen_supermarkt_männer.jpg',
        'stimuli/imgs/TS_kinobesucher_kaffeetrinken_bahnhof_frauen.jpg',
        'stimuli/imgs/TS_kinobesucher_kaffeetrinken_bahnhof_gemischt.jpg',
        'stimuli/imgs/TS_kinobesucher_kaffeetrinken_bahnhof_männer.jpg',
        'stimuli/imgs/TS_kinobesucher_lesen_burg_frauen.jpg',
        'stimuli/imgs/TS_kinobesucher_lesen_burg_gemischt.jpg',
        'stimuli/imgs/TS_kinobesucher_lesen_burg_männer.jpg',
        'stimuli/imgs/TS_kinobesucher_liegen_brunnen_gemischt.jpg',
        'stimuli/imgs/TS_kinobesucher_liegen_brunnen_männer.jpg',
        'stimuli/imgs/TS_kinosbesucher_liegen_brunnen_frauen.jpg',
        'stimuli/imgs/TS_köche_boxen_bahnhof_frauen.jpg',
        'stimuli/imgs/TS_köche_boxen_bahnhof_gemischt.jpg',
        'stimuli/imgs/TS_köche_boxen_bahnhof_männer.jpg',
        'stimuli/imgs/TS_köche_laufen_burg_frauen.jpg',
        'stimuli/imgs/TS_köche_laufen_burg_gemischt.jpg',
        'stimuli/imgs/TS_köche_laufen_burg_männer.jpg',
        'stimuli/imgs/TS_köche_liegen_vulkan_frauen.jpg',
        'stimuli/imgs/TS_köche_liegen_vulkan_gemischt.jpg',
        'stimuli/imgs/TS_köche_liegen_vulkan_männer.jpg',
        'stimuli/imgs/TS_köche_schachspielen_zug_frauen.jpg',
        'stimuli/imgs/TS_köche_schachspielen_zug_gemischt.jpg',
        'stimuli/imgs/TS_köche_schachspielen_zug_männer.jpg',
        'stimuli/imgs/TS_köche_sitzen_bibliothek_frauen.jpg',
        'stimuli/imgs/TS_köche_sitzen_bibliothek_gemischt.jpg',
        'stimuli/imgs/TS_köche_sitzen_bibliothek_männer.jpg',
        'stimuli/imgs/TS_laborassistenten_boxen_zug_frauen.jpg',
        'stimuli/imgs/TS_laborassistenten_boxen_zug_gemischt.jpg',
        'stimuli/imgs/TS_laborassistenten_boxen_zug_männer.jpg',
        'stimuli/imgs/TS_laborassistenten_laufen_bibliothek_frauen.jpg',
        'stimuli/imgs/TS_laborassistenten_laufen_bibliothek_gemischt.jpg',
        'stimuli/imgs/TS_laborassistenten_laufen_bibliothek_männer.jpg',
        'stimuli/imgs/TS_laborassistenten_lesen_zug_frauen.jpg',
        'stimuli/imgs/TS_laborassistenten_lesen_zug_gemischt.jpg',
        'stimuli/imgs/TS_laborassistenten_lesen_zug_männer.jpg',
        'stimuli/imgs/TS_laborassistenten_schach_vulkan_frauen.jpg',
        'stimuli/imgs/TS_laborassistenten_schach_vulkan_gemischt.jpg',
        'stimuli/imgs/TS_laborassistenten_schach_vulkan_männer.jpg',
        'stimuli/imgs/TS_laborassistenten_seilspringen_burg_frauen.jpg',
        'stimuli/imgs/TS_laborassistenten_seilspringen_burg_gemischt.jpg',
        'stimuli/imgs/TS_laborassistenten_seilspringen_burg_männer.jpg',
        'stimuli/imgs/TS_laborassistenten_sitzen_flugzeug_frauen.jpg',
        'stimuli/imgs/TS_laborassistenten_sitzen_flugzeug_gemischt.jpg',
        'stimuli/imgs/TS_laborassistenten_sitzen_flugzeug_männer.jpg',
        'stimuli/imgs/TS_maler_essen_zoo_frauen.jpg',
        'stimuli/imgs/TS_maler_essen_zoo_gemischt.jpg',
        'stimuli/imgs/TS_maler_essen_zoo_männer.jpg',
        'stimuli/imgs/TS_maler_kaffeetrinken_brunnen_frauen.jpg',
        'stimuli/imgs/TS_maler_kaffeetrinken_brunnen_gemischt.jpg',
        'stimuli/imgs/TS_maler_kaffeetrinken_brunnen_männer.jpg',
        'stimuli/imgs/TS_maler_lesen_supermarkt_frauen.jpg',
        'stimuli/imgs/TS_maler_lesen_supermarkt_gemischt.jpg',
        'stimuli/imgs/TS_maler_lesen_supermarkt_männer.jpg',
        'stimuli/imgs/TS_maler_seilspringen_bahnhof_frauen.jpg',
        'stimuli/imgs/TS_maler_seilspringen_bahnhof_gemischt.jpg',
        'stimuli/imgs/TS_maler_seilspringen_bahnhof_männer.jpg',
        'stimuli/imgs/TS_musiker_essen_burg_frauen.jpg',
        'stimuli/imgs/TS_musiker_essen_burg_gemischt.jpg',
        'stimuli/imgs/TS_musiker_essen_burg_männer.jpg',
        'stimuli/imgs/TS_musiker_kaffeetrinken_bibliothek_frauen.jpg',
        'stimuli/imgs/TS_musiker_kaffeetrinken_bibliothek_gemischt.jpg',
        'stimuli/imgs/TS_musiker_kaffeetrinken_bibliothek_männer.jpg',
        'stimuli/imgs/TS_musiker_kaffeetrinken_zug_frauen.jpg',
        'stimuli/imgs/TS_musiker_kaffeetrinken_zug_gemischt.jpg',
        'stimuli/imgs/TS_musiker_kaffeetrinken_zug_männer.jpg',
        'stimuli/imgs/TS_musiker_liegen_bahnhof_frauen.jpg',
        'stimuli/imgs/TS_musiker_liegen_bahnhof_gemischt.jpg',
        'stimuli/imgs/TS_musiker_liegen_bahnhof_männer.jpg',
        'stimuli/imgs/TS_musiker_sitzen_supermarkt_frauen.jpg',
        'stimuli/imgs/TS_musiker_sitzen_supermarkt_gemischt.jpg',
        'stimuli/imgs/TS_musiker_sitzen_supermarkt_männer.jpg',
        'stimuli/imgs/TS_schwimmer_essen_bibliothek_frauen.jpg',
        'stimuli/imgs/TS_schwimmer_essen_bibliothek_gemischt.jpg',
        'stimuli/imgs/TS_schwimmer_essen_bibliothek_männer.jpg',
        'stimuli/imgs/TS_schwimmer_liegen_zug_frauen.jpg',
        'stimuli/imgs/TS_schwimmer_liegen_zug_gemischt.jpg',
        'stimuli/imgs/TS_schwimmer_liegen_zug_männer.jpg',
        'stimuli/imgs/TS_schwimmer_schach_bahnhof_frauen.jpg',
        'stimuli/imgs/TS_schwimmer_schach_bahnhof_gemischt.jpg',
        'stimuli/imgs/TS_schwimmer_schach_bahnhof_männer.jpg',
        'stimuli/imgs/TS_schwimmer_sitzen_burg_frauen.jpg',
        'stimuli/imgs/TS_schwimmer_sitzen_burg_gemischt.jpg',
        'stimuli/imgs/TS_schwimmer_sitzen_burg_männer.jpg',
        'stimuli/imgs/TS_sportler_boxen_vulkan_frauen.jpg',
        'stimuli/imgs/TS_sportler_boxen_vulkan_gemischt.jpg',
        'stimuli/imgs/TS_sportler_boxen_vulkan_männer.jpg',
        'stimuli/imgs/TS_sportler_boxen_zoo_frauen.jpg',
        'stimuli/imgs/TS_sportler_boxen_zoo_gemischt.jpg',
        'stimuli/imgs/TS_sportler_boxen_zoo_männer.jpg',
        'stimuli/imgs/TS_sportler_kaffeetrinken_bibliothek_frauen.jpg',
        'stimuli/imgs/TS_sportler_kaffeetrinken_bibliothek_gemischt.jpg',
        'stimuli/imgs/TS_sportler_kaffeetrinken_bibliothek_männer.jpg',
        'stimuli/imgs/TS_sportler_kaffeetrinken_burg_frauen.jpg',
        'stimuli/imgs/TS_sportler_kaffeetrinken_burg_gemischt.jpg',
        'stimuli/imgs/TS_sportler_kaffeetrinken_burg_männer.jpg',
        'stimuli/imgs/TS_sportler_laufen_brunnen_frauen.jpg',
        'stimuli/imgs/TS_sportler_laufen_brunnen_gemischt.jpg',
        'stimuli/imgs/TS_sportler_laufen_brunnen_männer.jpg',
        'stimuli/imgs/TS_sportler_lesen_vulkan_frauen.jpg',
        'stimuli/imgs/TS_sportler_lesen_vulkan_gemischt.jpg',
        'stimuli/imgs/TS_sportler_lesen_vulkan_männer.jpg',
        'stimuli/imgs/TS_sportler_seilspringen_flugzeug_frauen.jpg',
        'stimuli/imgs/TS_sportler_seilspringen_flugzeug_gemischt.jpg',
        'stimuli/imgs/TS_sportler_seilspringen_flugzeug_männer.jpg',
      ];
      
      var preload = {
        type: jsPsychPreload,
        images: possible_images,
        message: function() {
          return jsPsych.randomization.sampleWithReplacement(loading_messages, 1)
        }
      }

      var sentence_picture_procedure = {
        timeline: [
          {
            type: jsPsychHtmlKeyboardResponse,
            stimulus: '<p class = "normal-text">+</p>',
            choices: "NO_KEYS", // No keys allowed during fixation
            trial_duration: fixation_dur, // Duration of fixation in milliseconds
            response_ends_trial: false,
          },
          {
            type: jsPsychHtmlKeyboardResponse,
            stimulus: function(){
              return `<p class = "sentence-stim"> ${jsPsych.timelineVariable('sentence')} </p>`
            },
            choices: "NO_KEYS",
            trial_duration: sentence_duration,
          },
          {
            type: jsPsychHtmlKeyboardResponse,
            stimulus_width: 800,
            maintain_aspect_ratio: true,
            stimulus: function() {
              const picture_path = 'stimuli/imgs/' + jsPsych.timelineVariable('picture');
              return `<div class="picture-stim"><img src="${picture_path}" class="stimulus-image"></div>`;
            },
            prompt: '<p class = "normal-text">Ist das Bild passend zur Aussage? <br> Ja = "D" Nein "L"</p>',
            choices: possible_response_keys,
            trial_duration: picture_duration,
            response_ends_trial: true,
            post_trial_gap: rsi_duration,
            on_finish: function(data) {
                // Record accuracy and congruency
                data.condition = jsPsych.timelineVariable('condition');
            }
          }
        ],
        timeline_variables: stimulus_list,
        randomize_order: true
      }

      experiment_timeline = [instructions, sentence_picture_procedure];
      jsPsych.run(experiment_timeline);
    }

    // Initialize the experiment after the CSV is loaded
    Papa.parse('https://raw.githubusercontent.com/SLesche/gender-sentences/main/stimuli/available_stimuli.csv', {
      header: true,
      download: true,
      complete: function(results) {
        let available_stimuli = results.data; // Assign the parsed data to available_stimuli

        jsPsych.randomization.setSeed(subject_id); // Set seed for reproducibility
        console.log(subject_id, available_stimuli);
        setupExperiment(available_stimuli);  // Setup and start the experiment once the data is available
      }
    });
  </script>
</html>
